(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{142:function(e,t,a){},143:function(e,t,a){},238:function(e,t,a){e.exports=a(401)},243:function(e,t,a){},244:function(e,t,a){},245:function(e,t,a){},246:function(e,t,a){},247:function(e,t,a){},248:function(e,t,a){},249:function(e,t,a){},250:function(e,t,a){},253:function(e,t,a){},254:function(e,t,a){},255:function(e,t,a){},256:function(e,t,a){},257:function(e,t,a){},258:function(e,t,a){},259:function(e,t,a){},260:function(e,t,a){},395:function(e,t,a){},396:function(e,t,a){},397:function(e,t,a){},398:function(e,t,a){},399:function(e,t,a){},400:function(e,t,a){},401:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(190),c=a.n(l),o=a(20),i=a(430),s=(a(243),a(4)),u=a(40),m=a(15),d=a(8),f=a(191),p=a.n(f);a(244),a(245);function E(e){var t=e.title,a=e.size,n=e.position,l=e.children,c=e.stickToEnd,o=e.zIndex,i=e.fontSize,s=r.a.Children.toArray(l).map((function(e,t){return r.a.createElement("div",{key:t,className:"navbar_child"},e)})),u=s.slice(0,s.length-c),m=s.slice(s.length-c),f=a&&"vertical"===n?{width:a}:{height:a},p=i?{fontSize:i}:{};return r.a.createElement("div",{style:Object(d.a)({},f,{zIndex:o}),className:"navbar navbar__".concat(n)},r.a.createElement("div",{className:"navbar_header"},r.a.createElement("div",{className:"navbar_title",style:p},t),r.a.createElement("div",{className:"navbar_divider"})),r.a.createElement("div",{className:"navbar_body"},r.a.createElement("div",{className:"navbar_children"},u),r.a.createElement("div",{className:"navbar_children__end"},m)))}E.defaultProps={position:"vertical",stickToEnd:0,title:"Navbar",zIndex:null};var b=E;a(246);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var g=r.a.createElement("path",{d:"M85.365 43.085H81.535H77.676H73.846H69.986H66.156H62.296V46.945H66.156H69.986H73.846H77.676H81.535H85.365H89.226V43.085H85.365Z",fill:"#9EABA5"}),_=r.a.createElement("path",{d:"M81.535 77.705H77.676V81.535H81.535V77.705Z",fill:"#9EABA5"}),y=r.a.createElement("path",{d:"M81.535 8.465H77.676V12.325H81.535V8.465Z",fill:"#9EABA5"}),N=r.a.createElement("path",{d:"M77.676 73.846H73.846V77.705H77.676V73.846Z",fill:"#9EABA5"}),O=r.a.createElement("path",{d:"M77.676 12.325H73.846V16.155H77.676V12.325Z",fill:"#9EABA5"}),j=r.a.createElement("path",{d:"M73.845 70.016H69.986V73.846H73.845V70.016Z",fill:"#9EABA5"}),A=r.a.createElement("path",{d:"M73.845 16.155H69.986V20.015H73.845V16.155Z",fill:"#9EABA5"}),k=r.a.createElement("path",{d:"M69.986 66.154H66.156V70.015H69.986V66.154Z",fill:"#9EABA5"}),V=r.a.createElement("path",{d:"M69.986 20.015H66.156V23.845H69.986V20.015Z",fill:"#9EABA5"}),x=r.a.createElement("path",{d:"M66.156 62.324H62.296V66.154H66.156V62.324Z",fill:"#9EABA5"}),S=r.a.createElement("path",{d:"M66.156 23.845H62.296V27.705H66.156V23.845Z",fill:"#9EABA5"}),w=r.a.createElement("path",{d:"M62.296 58.465H58.466V62.324H62.296V58.465Z",fill:"#9EABA5"}),H=r.a.createElement("path",{d:"M62.296 27.705H58.466V31.535H62.296V27.705Z",fill:"#9EABA5"}),T=r.a.createElement("path",{d:"M43.056 66.154V70.016V73.846V77.705V81.535V85.395V89.225H46.916V85.395V81.535V77.705V73.846V70.016V66.154V62.324H43.056V66.154Z",fill:"#9EABA5"}),C=r.a.createElement("path",{d:"M43.056 4.635V8.465V12.325V16.155V20.015V23.845V27.705H46.916V23.845V20.015V16.155V12.325V8.465V4.635V0.775002H43.056V4.635Z",fill:"#9EABA5"}),L=r.a.createElement("path",{d:"M31.535 58.465H27.676V62.324H31.535V58.465Z",fill:"#9EABA5"}),R=r.a.createElement("path",{d:"M31.535 27.705H27.676V31.535H31.535V27.705Z",fill:"#9EABA5"}),M=r.a.createElement("path",{d:"M27.676 62.324H23.846V66.154H27.676V62.324Z",fill:"#9EABA5"}),B=r.a.createElement("path",{d:"M27.676 23.845H23.846V27.705H27.676V23.845Z",fill:"#9EABA5"}),P=r.a.createElement("path",{d:"M23.845 66.154H19.986V70.015H23.845V66.154Z",fill:"#9EABA5"}),I=r.a.createElement("path",{d:"M23.845 20.015H19.986V23.845H23.845V20.015Z",fill:"#9EABA5"}),D=r.a.createElement("path",{d:"M19.986 70.016H16.156V73.846H19.986V70.016Z",fill:"#9EABA5"}),z=r.a.createElement("path",{d:"M19.986 16.155H16.156V20.015H19.986V16.155Z",fill:"#9EABA5"}),U=r.a.createElement("path",{d:"M16.156 73.846H12.296V77.705H16.156V73.846Z",fill:"#9EABA5"}),q=r.a.createElement("path",{d:"M16.156 12.325H12.296V16.155H16.156V12.325Z",fill:"#9EABA5"}),Z=r.a.createElement("path",{d:"M12.296 77.705H8.466V81.535H12.296V77.705Z",fill:"#9EABA5"}),F=r.a.createElement("path",{d:"M12.296 46.945H16.156H19.986H23.846H27.676V43.085H23.846H19.986H16.156H12.296H8.46599H4.60499H0.774994V46.945H4.60499H8.46599H12.296Z",fill:"#9EABA5"}),G=r.a.createElement("path",{d:"M12.296 8.465H8.466V12.325H12.296V8.465Z",fill:"#9EABA5"}),W=function(e){var t=e.svgRef,a=e.title,n=h(e,["svgRef","title"]);return r.a.createElement("svg",v({width:90,height:90,viewBox:"0 0 90 90",fill:"none",ref:t},n),a?r.a.createElement("title",null,a):null,g,_,y,N,O,j,A,k,V,x,S,w,H,T,C,L,R,M,B,P,I,D,z,U,q,Z,F,G)},J=r.a.forwardRef((function(e,t){return r.a.createElement(W,v({svgRef:t},e))}));a.p;function Y(e){var t=e.title,a=e.width,n=e.blank,l=e.children,c=e.className,o=e.style,i=e.empty,s=e.emptyText,u=n?" window__blank":"",m=r.a.createElement("div",{className:"window window__empty "+c,style:Object(d.a)({width:a},o)},t&&r.a.createElement("div",{className:"window_title"},r.a.createElement("h2",null,t)),r.a.createElement("div",{className:"window_body"},r.a.createElement("div",{className:"window__empty-icon"},r.a.createElement(J,null)),r.a.createElement("div",{className:"window__empty-text"},s.split("\\").map((function(e){return r.a.createElement(r.a.Fragment,null,e,r.a.createElement("br",null))})))));return i?m:r.a.createElement("div",{className:"window"+u+" "+c,style:Object(d.a)({width:a},o)},!n&&t&&r.a.createElement("div",{className:"window_title"},r.a.createElement("h2",null,t)),r.a.createElement("div",{className:"window_body"},l))}Y.defaultProps={blank:!1,style:{},empty:!1,emptyText:"\u0417\u0434\u0435\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442.",className:""};var K=Y,X=(a(247),{form:" form-button",corner:" corner-button"});function $(e){var t=e.type,a=e.corner,n=e.submit,l=e.text,c=e.onClick,o=e.disabled,i=e.color,s=(e.formHeight,e.className),u=e.style,m=X[t]+"_btn__"+i,d=a?"__"+a:"",f=a?X[t]+"_btn"+d:"",p=n?r.a.createElement("input",{className:s+X[t]+"_btn"+m+f,disabled:o,onClick:c,type:"submit",value:l,style:u}):r.a.createElement("button",{className:s+X[t]+"_btn"+m+f,disabled:o,onClick:c,style:u},l);return r.a.createElement("div",{className:X[t]+X[t]+d},p)}$.defaultProps={type:"form",submit:!1,corner:"",text:"",disabled:!1,color:"green",className:""};var Q=$;a(248);function ee(e){var t=e.content,a=e.cols,n=e.header,l=e.boldRows,c=e.centeredCols,o=n?r.a.createElement("thead",{className:"table_thead"},r.a.createElement("tr",null,n.map((function(e){return r.a.createElement("th",null,e)})))):"",i=r.a.createElement("tbody",{className:"table_tbody"},t.map((function(e,t){return r.a.createElement("tr",null,e.map((function(e,n){var o=a&&a[n]?"!"===a[n][0]?{width:a[n].slice(1)+"px"}:{minWidth:a[n]+"px"}:{},i=c.includes(n)?{textAlign:"center"}:{};return r.a.createElement("td",{style:Object(d.a)({},o,{},i),className:l.includes(t)?"table_td__bold":""},isNaN(e)?e:Number(e).toFixed(1))})))})));return r.a.createElement("div",{className:"table"},r.a.createElement("table",{className:"table-tag"},o,i))}ee.defaultProps={content:[],boldRows:[],centeredCols:[]};var te=ee,ae=(a(249),a(250),{dots:" data-table_field-leader__dots",centeredDots:" data-table_field-leader__centered-dots",none:""}),ne={small:" data-table__small",normal:"",large:" data-table__large"};function re(e){e.name;var t=e.fields,a=e.size,n=e.leader,l=(e.separator,e.colorScheme,t.map((function(e,t){return r.a.createElement("li",{className:"data-table_field",key:t},r.a.createElement("div",{className:"data-table_field-name"},e.label||e.name),r.a.createElement("div",{className:"data-table_field-leader"+ae[n]}),e.sign?r.a.createElement("div",{className:"data-table_field-sign"},e.sign):"",r.a.createElement("div",{className:"data-table_field-value"},Number(e.value).toFixed(e.unit.accuracy)),r.a.createElement("div",{className:"data-table_field-unit"},e.unit.name))})));return r.a.createElement("ul",{className:"data-table"+ne[a]},l)}re.defaultProps={fields:[],size:"normal",leader:"dots",separator:"none",colorScheme:"main"};var le=re,ce={3:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041e\u0431\u0435\u0434","\u0423\u0436\u0438\u043d"],4:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u0423\u0436\u0438\u043d"],5:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u0423\u0436\u0438\u043d"],6:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u0423\u0436\u0438\u043d","\u041f\u0435\u0440\u0435\u043a\u0443\u0441"],7:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u0412\u0442\u043e\u0440\u043e\u0439 \u0437\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u0423\u0436\u0438\u043d","\u041f\u0435\u0440\u0435\u043a\u0443\u0441"]},oe=["\u041f\u0440\u043e\u0434\u0443\u043a\u0442","\u041f\u043e\u0440\u0446\u0438\u044f","\u0411","\u0416","\u0423","\u042d\u043d\u0435\u0440\u0433\u0438\u044f"];function ie(e){var t=e.plan,a=ce[t.length],n=t.map((function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,a[t]),r.a.createElement("div",{className:"meal-plan_meal-table"},r.a.createElement(te,{content:e,header:t?null:oe,boldRows:[e.length-1],centeredCols:[1,2,3,4,5],cols:["!230",65,40,40,40,70]})))}));return r.a.createElement("div",{className:"meal-plan"},n)}ie.defaultProps={plan:[[],[],[]]};var se=ie,ue=a(141),me=function(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh),console.log("Saved access and refresh tokens to local storage",e.access,e.refresh)},de=function(){var e={refresh:localStorage.getItem("refresh_token")};if(!e)throw{data:"No refresh token",status:400,logout:!0};return fetch("/api/auth/refresh_token/",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json().then((function(t){return new Promise((function(a,n){e.ok?(me(t),a({data:t,status:e.status})):400===e.status||401===e.status?n({status:e.status,data:"Could not refresh token",logout:!0}):n({status:e.status,data:"Could not refresh token"})}))}))}))},fe=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n="POST"===a,r=function(e){return{method:a,headers:{Authorization:"Bearer "+e}}},l=function(t){return{method:a,headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify(e)}};return console.log("401 Unauthorized: ".concat(t)),de().then((function(e){return console.log("Retrying ".concat(t,". Refresh tokens: "),e,e.status),new Promise((function(t){t(e.status)}))})).then((function(e){var a=localStorage.getItem("access_token");return console.log("Sending 2nd req"),fetch(t,n?l(a):r(a))})).then((function(e){return e.json().then((function(t){return new Promise((function(a,n){e.ok?a({data:t,status:e.status}):n({status:e.status,data:"2nd attempt failed",logout:!0})}))}))}))},pe={portion:{label:"\u041c\u0430\u0441\u0441\u0430",unit:{accuracy:.01,name:"\u0433"}},protein:{label:"\u0411\u0435\u043b\u043a\u0438",unit:{accuracy:.01,name:"\u0433"}},fat:{label:"\u0416\u0438\u0440\u044b",unit:{accuracy:.01,name:"\u0433"}},carbohydrate:{label:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b",unit:{accuracy:.01,name:"\u0433"}},energy:{label:"\u042d\u043d\u0435\u0440\u0433\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u044c",unit:{accuracy:.01,name:"\u043a\u043a\u0430\u043b"}},water:{label:"\u0412\u043e\u0434\u0430",unit:{accuracy:.01,name:"\u043c\u043b"}},sfa:{label:"\u041d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u044b\u0435 \u0436\u0438\u0440\u043d\u044b\u0435 \u043a\u0438\u0441\u043b\u043e\u0442\u044b",unit:{accuracy:.01,name:"\u0433"}},mds:{label:"\u041c\u043e\u043d\u043e- \u0438 \u0434\u0438\u0441\u0430\u0445\u0430\u0440\u0438\u0434\u044b",unit:{accuracy:.01,name:"\u0433"}},starch:{label:"\u041a\u0440\u0430\u0445\u043c\u0430\u043b",unit:{accuracy:.01,name:"\u0433"}},fiber:{label:"\u041f\u0438\u0449\u0435\u0432\u044b\u0435 \u0432\u043e\u043b\u043e\u043a\u043d\u0430",unit:{accuracy:.01,name:"\u0433"}},sodium:{label:"\u041d\u0430\u0442\u0440\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},potassium:{label:"\u041a\u0430\u043b\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},calcium:{label:"\u041a\u0430\u043b\u044c\u0446\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},magnesium:{label:"\u041c\u0430\u0433\u043d\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},phosphorus:{label:"\u0424\u043e\u0441\u0444\u043e\u0440",unit:{accuracy:.01,name:"\u043c\u0433"}},iron:{label:"\u0416\u0435\u043b\u0435\u0437\u043e",unit:{accuracy:.01,name:"\u043c\u0433"}},thiamine:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B1",unit:{accuracy:.01,name:"\u043c\u0433"}},riboflavin:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B2",unit:{accuracy:.01,name:"\u043c\u0433"}},niacin:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d PP",unit:{accuracy:.01,name:"\u043c\u0433"}},beta_carotene:{label:"\u0411\u0435\u0442\u0430-\u043a\u0430\u0440\u043e\u0442\u0438\u043d",unit:{accuracy:.01,name:"\xb5\u0433"}},vitamin_c:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d C",unit:{accuracy:.01,name:"\u043c\u0433"}},cholesterol:{label:"\u0425\u043e\u043b\u0435\u0441\u0442\u0435\u0440\u0438\u043d",unit:{accuracy:.01,name:"\u043c\u0433"}},retinol:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d A",unit:{accuracy:.01,name:"\xb5\u0433"}}},Ee=function(e){return{Authorization:"Bearer "+e}};function be(e){var t=e.auth,a=e.onAuth,l=e.onPlanRequest,c=e.awaitingNewPlan,o=Object(n.useState)([]),i=Object(s.a)(o,2),u=(i[0],i[1]),f=Object(n.useState)([]),E=Object(s.a)(f,2),v=E[0],h=E[1],g=Object(n.useState)([]),_=Object(s.a)(g,2),y=_[0],N=_[1],O=Object(n.useState)(0),j=Object(s.a)(O,2),A=j[0],k=j[1],V=function(e){var t=["name","categories","source_categories"],a=Object(d.a)({},e),n=a.portions,r=a.size,l=Array(r).fill([]),c=Array(r).fill([]),o={};return n.forEach((function(e){for(var a=e.meal_no-1,n=e.food,r=0,i=Object.entries(n);r<i.length;r++){var u=Object(s.a)(i[r],2),d=u[0],f=u[1];!t.includes(d)&&f&&(d in o?o[d]+=f:o[d]=f)}var p=[n.portion,n.protein,n.fat,n.carbohydrate,n.energy];c[a].length?c[a]=c[a].map((function(e,t){return e+p[t]})):c[a]=p,l[a]=[].concat(Object(m.a)(l[a]),[[n.name].concat(p)])})),o=Object.keys(pe).map((function(e){return Object(d.a)({},pe[e],{value:o[e]})})),[l=l.map((function(e,t){return[].concat(Object(m.a)(e),[["\u0418\u0442\u043e\u0433\u043e"].concat(Object(m.a)(c[t]))])})),o]},x=function(){console.log("generating new plan"),fetch("/api/generate_meal_plan/",{headers:Ee(localStorage.getItem("access_token"))}).then((function(e){if(!e.ok)throw{status:e.status,data:"Failed to fetch"};return e.json()})).then((function(e){u((function(t){return[].concat(Object(m.a)(t),[e])}));var t=V(e),a=Object(s.a)(t,2),n=a[0],r=a[1];h((function(e){return[].concat(Object(m.a)(e),[n])})),N((function(e){return[].concat(Object(m.a)(e),[r])}))})).catch((function(e){if(401===e.status)return fe(null,"/api/generate_meal_plan/","GET").then((function(e){u((function(t){return[].concat(Object(m.a)(t),[e.data])}));var t=V(e.data),a=Object(s.a)(t,2),n=a[0],r=a[1];h((function(e){return[].concat(Object(m.a)(e),[n])})),N((function(e){return[].concat(Object(m.a)(e),[r])})),console.log("retryRequest successful",e.status,e.data)})).catch((function(e){e.logout&&a(!1),console.error("retryRequest error!",e.status,e.data,e)}));console.error(e)}))},S=function(e){var t=v.length;k("next"===e?A<t-1?function(e){return e+1}:0:0===A?t-1:function(e){return e-1})};Object(n.useEffect)((function(){console.log("fetching plans"),fetch("/api/get_meal_plans/",{headers:Ee(localStorage.getItem("access_token"))}).then((function(e){if(!e.ok)throw{status:e.status,data:"Failed to fetch"};return e.json()})).then((function(e){u(e);var t=[],a=[];e.forEach((function(e){var n=V(e),r=Object(s.a)(n,2),l=r[0],c=r[1];t.push(l),a.push(c)})),h(t),N(a)})).catch((function(e){if(console.log("SOME ERROR"),console.log(e),401===e.status)return fe(null,"/api/get_meal_plans/","GET").then((function(e){u(e);var t=[],a=[];e.forEach((function(e){var n=V(e),r=Object(s.a)(n,2),l=r[0],c=r[1];t.push(l),a.push(c)})),h(t),N(a),console.log("retryRequest successful",e.status,e.data)})).catch((function(e){e.logout&&a(!1),console.error("retryRequest error!",e.status,e.data,e)}))}))}),[t]),Object(n.useEffect)((function(){k(v.length-1),console.log("Change current plan")}),[v]),Object(n.useEffect)((function(){c&&(l(!1),x())}),[c]);return r.a.createElement("div",{className:"meal-plan-page",style:t?{}:{filter:"blur(10px)"}},r.a.createElement("div",{className:"meal-plan-page_navbar"},r.a.createElement(b,{title:"\u041f\u0438\u0449\u0435\u0432\u0430\u044f \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u044c",size:"350px",fontSize:"24px"},r.a.createElement(le,{fields:y[A]}))),r.a.createElement("div",{className:"meal-plan-page_main-area"},r.a.createElement("div",{className:"meal-plan-page_container"},r.a.createElement(K,{width:"700px",blank:!0,className:"meal-plan_header-window"},r.a.createElement("div",{className:"meal-plan_header"},r.a.createElement("div",{className:"meal-plan_title"},r.a.createElement("h2",null,"\u041f\u043b\u0430\u043d \u043f\u0438\u0442\u0430\u043d\u0438\u044f")),r.a.createElement("div",{className:"meal-plan_refresh"},r.a.createElement(Q,{type:"corner",corner:"top-right",text:"\u21ba",style:{fontSize:"31px"},onClick:x})),r.a.createElement("div",{className:"meal-plan_header-body"},"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 ",r.a.createElement("span",{onClick:function(){v.length&&v[A].length&&p.a.toPng(document.querySelector(".meal-plan"),{bgcolor:"#f5f6f6"}).then((function(e){var t=document.createElement("a");t.download="meal-plan.png",t.href=e,t.click()}))},className:"meal-plan_download"},"\u0441\u044e\u0434\u0430"),", \u0447\u0442\u043e\u0431\u044b \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u043f\u043b\u0430\u043d \u043f\u0438\u0442\u0430\u043d\u0438\u044f"))),r.a.createElement(K,{width:"700px",empty:!v.length,emptyText:"\u0417\u0434\u0435\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442.\\\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b."},r.a.createElement("div",{className:"meal-plan_select-buttons"},r.a.createElement("div",{className:"meal-plan_prev-button",onClick:function(){return S("prev")}},"\u2190"),r.a.createElement("div",{className:"meal-plan_next-button",onClick:function(){return S("next")}},"\u2192")),r.a.createElement(se,{plan:v[A]})))))}be.defaultProps={};var ve=be,he=(a(253),a(142),a(14)),ge=a(427);a(61);function _e(e){e.type;var t=e.value,a=e.name,n=e.label,l=e.disabled,c=e.validityErrors,o=e.onChange,i=e.placeholder,s=e.maxLength,u=e.displayErrors,m=e.subtype,d=0===c.length?"":" input_input-tag__error",f=0===c.length?"":" input_label__error";return r.a.createElement("div",{className:"input"},r.a.createElement("label",{className:"input_label-tag"},r.a.createElement("div",{className:"input_label"+f},n),r.a.createElement("input",{className:"input_input-tag"+d,type:m||"text",name:a,value:t,placeholder:i||a,disabled:l,onChange:o,maxLength:s})),r.a.createElement("ul",{className:"input_validity-errors"},u&&c.map((function(e,t){return r.a.createElement("li",{className:"input_validity-error",key:t},e)}))))}_e.defaultProps={type:"text",value:"",name:"Text",disabled:!1};var ye=_e;a(143);function Ne(e){var t=e.name,a=e.label,n=e.options,l=e.value,c=e.onChange,o=e.validityErrors,i=e.displayErrors,s=0===o.length?"":" radio-group_options__error",u=0===o.length?"":" input_label__error",m=n.map((function(e,a){var n=l===e.name?" radio-group_option__selected":"";return r.a.createElement("label",{className:"radio-group_option"+n,key:a},r.a.createElement("input",{type:"radio",name:t,value:e.name,checked:l===e.name,onChange:c}),r.a.createElement("div",{className:"radio-group_label"},e.label||e.name))}));return r.a.createElement("div",{className:"input"},r.a.createElement("div",{className:"input_label"+u},a||t),r.a.createElement("div",{className:"radio-group_options"+s},m),r.a.createElement("ul",{className:"input_validity-errors"},i&&o.map((function(e,t){return r.a.createElement("li",{className:"input_validity-error",key:t},e)}))))}Ne.defaultProps={options:[],validityErrors:[]};var Oe=Ne;a(254);function je(e){var t=e.name,a=e.label,l=e.options,c=e.value,o=e.onChange,i=e.double,u=(e.validityErrors,e.displayErrors,e.dropdownWidth),m=Object(n.useState)(!1),d=Object(s.a)(m,2),f=d[0],p=d[1],E=i?" select__double":"",b=i?" select_dropdown__double":"",v=function(e){var a=e.currentTarget.id;o({currentTarget:{value:a,name:t,type:"select"}})},h=l.filter((function(e){return e.name===c})).map((function(e,t){return r.a.createElement("div",{id:e.name,className:"select_option",key:t},r.a.createElement("div",{className:"select_option-label"},e.label),r.a.createElement("div",{className:"select_option-description"},e.description))})),g=l.filter((function(e){return e.name!==c})).map((function(e,t){return r.a.createElement("div",{id:e.name,className:"select_option",onClick:v,key:t},r.a.createElement("div",{className:"select_option-label"},e.label),r.a.createElement("div",{className:"select_option-description"},e.description))})),_=r.a.createElement("div",{className:"select_dropdown"+b},h,g);return r.a.createElement("div",{className:"input input__select",onClick:function(e){p((function(e){return!e}))}},r.a.createElement("div",{className:"input_label"},a),r.a.createElement("div",{className:"select"+E,name:t},h),r.a.createElement("div",{className:"select_dropdown-container",style:{width:100*u+"%"}},f&&_))}je.defaultProps={dropdownWidth:1};var Ae=je;a(255);function ke(e){var t=e.name,a=e.label,l=e.options,c=e.value,o=e.onChange,i=(e.double,Object(n.useState)(0)),u=Object(s.a)(i,2),m=u[0],d=u[1];Object(n.useEffect)((function(){d(l.findIndex((function(e){return e.name===c})))}),[c]);return r.a.createElement("div",{className:"input"},r.a.createElement("div",{className:"input_label"},a),r.a.createElement("div",{className:"slider_container"},r.a.createElement("div",{className:"slider"},r.a.createElement("input",{type:"range",value:m,onChange:function(e){var a=l[e.currentTarget.value].name;o({currentTarget:{value:a,name:t,type:"slider"}})},min:0,max:l.length-1,step:1})),r.a.createElement("div",{className:"slider_info"},l[m]&&l[m].label,r.a.createElement("div",{className:"slider_info-detailed"},l[m]&&l[m].description))))}ke.defaultProps={options:[]};var Ve=ke,xe=a(39);a(256);function Se(e){var t=e.name,a=e.label,l=e.options,c=e.value,o=e.onChange,i=e.validityErrors,u=e.displayErrors,f=e.layout,p=e.tooltipWidth,E=Object(n.useState)({}),b=Object(s.a)(E,2),v=b[0],h=b[1],g=0===i.length?"":" radio-group_options__error",_=0===i.length?"":" input_label__error",y=3===f.length?" checkbox-group_options__double":"";Object(n.useEffect)((function(){var e=new ResizeObserver((function(e){var t,a=Object(xe.a)(e);try{var n=function(){var e=t.value,a=e.target.dataset.name.split("--").slice(1).join("-");h((function(t){return Object(d.a)({},t,Object(he.a)({},a,e.contentRect.width))}))};for(a.s();!(t=a.n()).done;)n()}catch(r){a.e(r)}finally{a.f()}}));document.querySelectorAll('input[type="checkbox"] ~ .radio-group_label').forEach((function(t){e.observe(t)}))}),[]);var N=function(e){var a=new Set(c);e.target.checked?a.add(e.target.name):a.delete(e.target.name),o({currentTarget:{value:Object(m.a)(a),name:t,type:"checkbox"}})};if(1!==f.length&&3!==f.length)throw new Error("layout.length should be 1 or 3");var O=l.map((function(e,a){var n=c&&c.includes(e.name)?" radio-group_option__selected":"",l=e.description?r.a.createElement("div",{className:"radio-group_tooltip-container"},r.a.createElement("div",{style:{minWidth:p},className:"radio-group_tooltip"},r.a.createElement("div",{className:"radio-group_tooltip-name radio-group_label",style:{width:v[e.name]}},e.label),r.a.createElement("div",{className:"radio-group_tooltip-description"},e.description))):"";return r.a.createElement("label",{className:"radio-group_option"+n,key:a},r.a.createElement("input",{type:"checkbox",name:e.name,checked:!!c&&c.includes(e.name),onChange:N}),r.a.createElement("div",{className:"radio-group_label","data-name":t+"--"+e.name},e.label||e.name),l)})),j=f.map((function(e,t){return r.a.createElement("div",{className:"checkbox-group_options-row",key:t},O.splice(0,e))}));return r.a.createElement("div",{className:"input"},r.a.createElement("div",{className:"input_label"+_},a||t),r.a.createElement("div",{className:"radio-group_options checkbox-group_options"+g+y},j),r.a.createElement("ul",{className:"input_validity-errors"},u&&i.map((function(e,t){return r.a.createElement("li",{className:"input_validity-error",key:t},e)}))))}Se.defaultProps={options:[],validityErrors:[],layout:[5],tooltipWidth:"140px"};var we=Se,He=ye,Te=(a(257),{0:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c","1-p":function(e){return"\u041f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 ".concat(e," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}}),Ce={0:"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f","1-p":function(e){return"\u041d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u0443\u0434\u043e\u0432\u043b\u0435\u0442\u0432\u043e\u0440\u044f\u044e\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}},Le={401:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0442\u0430\u043a\u0438\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"};function Re(e){var t=e.fields,a=e.formTitle,l=(e.submitText,e.submitUrl),c=e.singleErrorList,o=e.columns,i=e.sections,u=e.width,m=e.dataToSend,f=e.headers,p=e.withAuth,E=e.onResponse,b=e.errorsToDisplay,v=e.onFieldChange,h=Object(ge.a)(),g=Object(s.a)(h,2),_=g[0],y=(g[1],Object(n.useState)({})),N=Object(s.a)(y,2),O=N[0],j=N[1],A=Object(n.useState)({}),k=Object(s.a)(A,2),V=k[0],x=k[1],S=t.reduce((function(e,t){return Object(d.a)({},e,Object(he.a)({},t.name,RegExp(t.regex)||/[\s\S]*/))}),{}),w=t.reduce((function(e,t){return Object(d.a)({},e,Object(he.a)({},t.name,!!t.required))}),{}),H=t.reduce((function(e,t){return Object(d.a)({},e,Object(he.a)({},t.name,t.minLength||0))}),{});Object(n.useEffect)((function(){var e=t.reduce((function(e,t){return Object(d.a)({},e,Object(he.a)({},t.name,t.initialValue||""))}),{}),a=t.reduce((function(e,t){return Object(d.a)({},e,Object(he.a)({},t.name,{}))}),{});j(e),x(a)}),[t]);var T=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;x((function(r){return Object(d.a)({},r,Object(he.a)({},e,Object(d.a)({},r[e],Object(he.a)({},t,[a,n]))))}))},C=function(e,t){var a=""===t&&w[e];return T(e,0,a),!a},L=function(e){var t,a,n=e.currentTarget;"radio"===n.type||"checkbox"===n.type?(C(n.name,n.value),v(n.name,n.value),j((function(e){return Object(d.a)({},e,Object(he.a)({},n.name,n.value))}))):(t=n.name,(""===(a=n.value)||S[t].test(a))&&(C(n.name,n.value),function(e,t){if(!H[e])return!0;var a=0!==t.length&&t.length<H[e];T(e,"1-p",a,H[e])}(n.name,n.value),v(n.name,n.value),j((function(e){return Object(d.a)({},e,Object(he.a)({},n.name,n.value))}))))},R=[],M=t.map((function(e,t){var a=V[e.name]||{},n=c?Object.keys(a).filter((function(e){return a[e][0]})).map((function(e){return e.includes("-p")?Ce[e](a[e][1]):Ce[e]})):Object.keys(a).filter((function(e){return a[e][0]})).map((function(e){return e.includes("-p")?Te[e](a[e][1]):Te[e]}));return n.forEach((function(e){!R.includes(e)&&R.push(e)})),"radio"===e.type?r.a.createElement(Oe,Object.assign({},e,{key:t,onChange:L,value:O[e.name],validityErrors:n||[],displayErrors:!c})):"select"===e.type?r.a.createElement(Ae,Object.assign({},e,{key:t,onChange:L,value:O[e.name],validityErrors:n||[],displayErrors:!c})):"slider"===e.type?r.a.createElement(Ve,Object.assign({},e,{key:t,onChange:L,value:O[e.name],validityErrors:n||[],displayErrors:!c})):"checkbox"===e.type?r.a.createElement(we,Object.assign({},e,{key:t,onChange:L,value:O[e.name],validityErrors:n||[],displayErrors:!c})):r.a.createElement(He,Object.assign({},e,{onChange:L,value:O[e.name],validityErrors:n||[],key:t,displayErrors:!c}))})),B=(c&&0!==R.length||0!==b.length)&&r.a.createElement("ul",{className:"form_validity-errors"},c&&R.map((function(e,t){return r.a.createElement("li",{className:"form_validity-error",key:t},e)})),b.map((function(e,t){return r.a.createElement("li",{className:"form_validity-error",key:t},e)}))),P=(0!==i.length?i:[{title:a,size:100,columns:o}]).map((function(e,t){var a=M.splice(0,e.size),l={gridTemplateColumns:"1fr ".repeat(e.columns)},c=0!==t?r.a.createElement("div",{className:"form_section-delimeter"}):"";return r.a.createElement(n.Fragment,{key:t},c,e.title&&r.a.createElement("div",{className:"form_title"},r.a.createElement("h2",null,e.title)),r.a.createElement("div",{className:"form_fields",style:l},a))}));return r.a.createElement("form",{className:"form",style:{width:u},onSubmit:function(e){var a=_.csrftoken?{"X-CSRFToken":_.csrftoken}:{},n=p?{Authorization:"Bearer "+localStorage.getItem("access_token")}:{};(function(){var e=t.filter((function(e){return w[e.name]})).reduce((function(e,t){return C(t.name,O[t.name])&&e}),!0),a=Object.values(V).reduce((function(e,t){return Object.values(t).reduce((function(e,t){return!t[0]&&e}),!0)&&e}),!0);return e&&a})()&&fetch(l,{method:"POST",body:JSON.stringify(Object(d.a)({},O,{},m)),headers:Object(d.a)({"Content-Type":"application/json"},a,{},f,{},n)}).then((function(e){e.json().then((function(t){E(Object(d.a)({},O,{},m),t,e.status,"/"+e.url.split("/").slice(3).join("/")),console.log(e)}))})),e.preventDefault()},noValidate:!0,autoComplete:"off"},r.a.createElement("div",{className:"form_body"},P,B),r.a.createElement(Q,{type:"form",submit:!0}))}Re.defaultProps={fields:[],columns:1,singleErrorList:!0,formTitle:"",dataToSend:{},headers:{},errorsToDisplay:[],onFieldChange:function(){},sections:[]};var Me=Re;a(258),a(259);function Be(e){var t=e.name,a=e.label,n=e.value,l=e.unit,c=e.alternativeUnits,o=r.a.createElement("div",{className:"data-square_field",key:-1},Number(n).toFixed(l.accuracy)+" "+l.name),i=c.map((function(e,t){return r.a.createElement("div",{className:"data-square_field",key:t},Number(n*e.rate).toFixed(e.accuracy)+" "+e.name)}));return r.a.createElement("div",{className:"data-square"},r.a.createElement("div",{className:"data-square_title"},a||t),r.a.createElement("div",{className:"data-square_fields"},[o].concat(Object(m.a)(i))))}Be.defaultProps={label:"Title",value:6,unit:{name:"kg",accuracy:1},alternativeUnits:[]};var Pe=Be;function Ie(e){var t=e.input,a=e.result,n=e.model,l="row"===e.layout?" result-section__row":"",c=n.SOURCE_FIELDS.map((function(e,a){var n=e.LABEL||e.NAME,l=e.CATEGORIAL?e.VALUES.find((function(a){return a.NAME===t[e.NAME]})).LABEL||t[e.NAME]:t[e.NAME]+(e.UNIT?" "+e.UNIT:"");return r.a.createElement("div",{className:"result-section_source",key:a},r.a.createElement("div",{className:"result-section_source-name"},n),r.a.createElement("div",{className:"result-section_source-value"},l))})),o={label:n.LABEL_TO_PREDICT.LABEL||n.LABEL_TO_PREDICT.NAME,name:n.LABEL_TO_PREDICT.NAME,value:a,unit:{name:n.LABEL_TO_PREDICT.UNIT,accuracy:n.LABEL_TO_PREDICT.ACCURACY},alternativeUnits:n.LABEL_TO_PREDICT.ALTERNATIVE_UNITS.map((function(e){return{name:e.UNIT,rate:e.RATE,accuracy:e.ACCURACY}}))};return r.a.createElement("div",{className:"result-section"+l},r.a.createElement("div",{className:"result-section_sources"},r.a.createElement("div",{className:"result-section_sources-title"},"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b"),c),r.a.createElement("div",{className:"result-section_results"},r.a.createElement(Pe,o)))}Ie.defaultProps={layout:"column"};var De=Ie,ze=(a(260),a(192));function Ue(e){var t=e.model,a=[];t&&t.PREDICTED_VALUES.forEach((function(e,n){a.push({x:e,y:t.TRUE_VALUES[n]})}));var n=[{id:"\u041f\u041e\u041e",data:a}],l=r.a.createElement("table",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\u041c\u0435\u0442\u0440\u0438\u043a\u0430"),r.a.createElement("th",null,"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435")),t.TEST_METRICS.map((function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.FULL_LABEL),r.a.createElement("td",null,e.VALUE.toFixed(4)))})));return r.a.createElement("div",{className:"model-info-section"},r.a.createElement("div",{className:"model-info-section_plot"},r.a.createElement(ze.a,{data:n,margin:{top:40,right:60,bottom:40,left:60},xScale:{type:"linear",min:0,max:12.055},xFormat:function(e){return e.toFixed(3)+" \u041c\u0414\u0436/\u0441\u0443\u0442"},yScale:{type:"linear",min:0,max:12.055},yFormat:function(e){return e.toFixed(3)+" \u041c\u0414\u0436/\u0441\u0443\u0442"},nodeSize:2,colors:"#A4145A",axisTop:null,axisRight:null,axisBottom:{orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"\u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f",legendPosition:"middle",legendOffset:35},axisLeft:{orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f",legendPosition:"middle",legendOffset:-35}})),l)}Ue.defaultProps={};var qe=Ue,Ze=function(e){return e.SOURCE_FIELDS.map((function(e){return e.CATEGORIAL?{name:e.NAME,label:e.LABEL||e.NAME,type:"radio",options:e.VALUES.map((function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];return[a.toLowerCase(),n]})))})),initialValue:e.DEFAULT_VALUE}:{name:e.NAME,label:(e.LABEL||e.NAME)+(e.UNIT?" (".concat(e.UNIT,")"):""),type:"text",regex:"^-?([0-9]+([.][0-9]*)?|[.][0-9]+)$",required:!0,maxLength:5,placeholder:e.DEFAULT_VALUE}}))};function Fe(e){var t=e.model,a=e.request,n=e.result,l=e.onResponse;if(!t)return r.a.createElement(u.a,{to:"/models"});var c={MODEL_NAME:t.MODEL_NAME},o=r.a.createElement(Me,{fields:Ze(t),columns:2,dataToSend:c,submitUrl:"/api/predict/",formTitle:t.MODEL_TITLE||t.MODEL_NAME,onResponse:function(e,a){Object.keys(c).forEach((function(t){delete e[t]})),l(t.MODEL_NAME,e,+a)}}),i=n&&a&&r.a.createElement(K,{title:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b"},r.a.createElement(De,{input:a,model:t,result:n,layout:"col"}));return r.a.createElement("div",{className:"model"},r.a.createElement(K,{width:"500px",className:"model-info-window"},r.a.createElement(qe,{model:t})," "),r.a.createElement(K,{blank:!0,width:"420px"},o),i)}Fe.defaultProps={};var Ge=Fe;function We(e){var t=e.models,a=Object(n.useState)({}),l=Object(s.a)(a,2),c=l[0],o=l[1],i=Object(n.useState)({}),m=Object(s.a)(i,2),f=m[0],p=m[1],E=Object(u.h)().modelName,b=t.find((function(e){return e.MODEL_NAME===E}));return Object(n.useEffect)((function(){console.log("Model rerender")}),[b]),b?r.a.createElement(Ge,{model:b,result:c[E],request:f[E],onResponse:function(e,t,a){p((function(a){return Object(d.a)({},a,Object(he.a)({},e,t))})),o((function(t){return Object(d.a)({},t,Object(he.a)({},e,a))}))}}):r.a.createElement(u.a,{to:"/models"})}We.defaultProps={};var Je=We;a(395);function Ye(e){e.name;var t=e.title,a=e.description,n=e.to,l=e.exact;return r.a.createElement(o.c,{to:n,activeClassName:"model-link__active",className:"model-link",exact:l},r.a.createElement("div",{className:"model-link_name"},t),r.a.createElement("div",{className:"model-link_description"},a))}Ye.defaultProps={exact:!1};var Ke=Ye;function Xe(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],l=t[1];Object(n.useEffect)((function(){fetch("/api/get_models/").then((function(e){return e.json()})).then((function(e){l(e)})).catch((function(e){return console.error("ERROR: ",e)}))}),[]);var c=a&&a.map((function(e,t){return r.a.createElement(Ke,{key:t,name:e.MODEL_NAME,title:e.MODEL_TITLE||e.MODEL_NAME,description:e.MODEL_DESCRIPTION,to:"/models/"+e.MODEL_NAME})}));return r.a.createElement("div",{className:"models-page"},r.a.createElement("div",{className:"models-page_navbar"},r.a.createElement(b,{title:"\u041c\u043e\u0434\u0435\u043b\u0438",size:"350px",fontSize:"24px"},c)),r.a.createElement("div",{className:"models-page_main-area"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/models"}),r.a.createElement(u.b,{path:"/models/:modelName",children:a&&r.a.createElement(Je,{models:a})}))))}Xe.defaultProps={};var $e=Xe;a(396),a(397);function Qe(e){var t=e.form,a=e.username,l=e.onSuccess,c=Object(n.useState)([]),o=Object(s.a)(c,2),i=o[0],u=o[1],m=Object(n.useState)(null),f=Object(s.a)(m,2),p=f[0],E=f[1];Object(n.useEffect)((function(){var e=a||localStorage.getItem("username")||null;E(e?t.map((function(t){return"username"===t.name?Object(d.a)({},t,{initialValue:e}):t})):t)}),[]);var b=p?r.a.createElement(Me,{columns:1,singleErrorList:!1,submitUrl:"/api/auth/get_token/",fields:p,formTitle:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442",onResponse:function(e,t,a){200===a?(u([]),l(t,e.username)):u([{errID:a,error:Le[a]}])},errorsToDisplay:i.map((function(e){return e.error})),onFieldChange:function(){return u([])}}):"";return r.a.createElement("div",{className:"login"},b)}Qe.defaultProps={username:null};var et=Qe;a(398);function tt(e){var t=e.form,a=e.onSuccess,l=Object(n.useState)([]),c=Object(s.a)(l,2),o=c[0],i=c[1],u=t?r.a.createElement(Me,{columns:1,singleErrorList:!1,submitUrl:"/api/auth/create/",fields:t,formTitle:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",onResponse:function(e,t,n){t.username?(i([]),a(t.username)):i(t)},errorsToDisplay:o.map((function(e){return e.error})),onFieldChange:function(){return i([])}}):"";return r.a.createElement("div",{className:"register"},u)}tt.defaultProps={};var at=tt;function nt(e){var t=e.onAuth,a=Object(n.useState)(null),l=Object(s.a)(a,2),c=l[0],o=l[1],i=Object(n.useState)("login"),u=Object(s.a)(i,2),m=u[0],d=u[1],f=Object(n.useState)(null),p=Object(s.a)(f,2),E=p[0],b=p[1];Object(n.useEffect)((function(){fetch("/api/get_forms/?forms=register,login").then((function(e){return e.json()})).then((function(e){o(e)})).catch((function(e){return console.error("ERROR: ",e)}))}),[]);var v=c&&r.a.createElement(et,{onSuccess:function(e,a){me(e),localStorage.setItem("username",a),t(!0)},username:E,form:c.login}),h=c&&r.a.createElement(at,{onSuccess:function(e){b(e),d("login")},form:c.register}),g="login"===m?r.a.createElement(K,{width:"500px",title:"\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?",style:{marginBottom:"15px"}},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a ",r.a.createElement("span",{onClick:function(){return d("register")},className:"auth-modal_link"},"\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438")):r.a.createElement(K,{width:"500px",title:"\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?",style:{marginBottom:"15px"}},"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 ",r.a.createElement("span",{onClick:function(){return d("login")},className:"auth-modal_link"},"\u0437\u0434\u0435\u0441\u044c"),", \u0447\u0442\u043e\u0431\u044b \u0432\u043e\u0439\u0442\u0438");return r.a.createElement("div",{className:"auth-modal_container"},r.a.createElement("div",{className:"auth-modal"},g,r.a.createElement(K,{blank:!0,width:"500px"},"login"===m?v:h)))}nt.defaultProps={};var rt=nt,lt=(a(399),a(400),[{label:"\u041f\u0438\u0449. \u0432\u043e\u043b\u043e\u043a\u043d\u0430",value:30,unit:{name:"\u0433",accuracy:.01}},{label:"\u041d\u0416\u041a",value:25,unit:{name:"\u0433",accuracy:.01},sign:"<"},{label:"\u041f\u041d\u0416\u041a",value:11,unit:{name:"\u0433",accuracy:.01},sign:">"},{label:"\u0425\u043e\u043b\u0435\u0441\u0442\u0435\u0440\u0438\u043d",value:300,unit:{name:"\u043c\u0433",accuracy:.01},sign:"<"},{label:"\u041d\u0430\u0442\u0440\u0438\u0439",value:2400,unit:{name:"\u043c\u0433",accuracy:.01},sign:"<"},{label:"\u041a\u0430\u043b\u0438\u0439",value:3500,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u041a\u0430\u043b\u044c\u0446\u0438\u0439",value:1e3,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0424\u043e\u0441\u0444\u043e\u0440",value:1e3,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0419\u043e\u0434",value:150,unit:{name:"\u03bc\u0433",accuracy:.01}},{label:"\u041c\u0430\u0433\u043d\u0438\u0439",value:400,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0416\u0435\u043b\u0435\u0437\u043e",value:14,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0426\u0438\u043d\u043a",value:9.5,unit:{name:"\u043c\u0433",accuracy:.01}}]),ct=[{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d A",value:1,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B1",value:1.5,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B2",value:1.8,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B3",value:20,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B6",value:1.3,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B9",value:400,unit:{name:"\u03bc\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B12",value:2.4,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d C",value:70,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d D",value:15,unit:{name:"\u03bc\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d E",value:10,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d K",value:120,unit:{name:"\u03bc\u0433",accuracy:.01}}];function ot(e){var t=e.auth,a=e.onAuth,l=e.onPlanRequest,c=Object(n.useState)(null),o=Object(s.a)(c,2),i=o[0],f=o[1],p=Object(n.useState)([]),E=Object(s.a)(p,2),b=E[0],v=E[1],h=Object(n.useState)(!1),g=Object(s.a)(h,2),_=g[0],y=g[1];Object(n.useEffect)((function(){!function(){var e;fetch("/api/get_preferences_page/",{headers:(e=localStorage.getItem("access_token"),{Authorization:"Bearer "+e})}).then((function(e){if(!e.ok)throw{status:e.status,data:"Failed to fetch"};return e.json()})).then((function(e){f(e.data),v(e.status)})).catch((function(e){if(401===e.status)return fe(null,"/api/get_preferences_page/","GET").then((function(e){f(e.data.data),v(e.data.status),console.log("retryRequest successful",e.status,e.data)})).catch((function(e){e.logout&&a(!1),console.error("retryRequest error!",e.status,e.data,e)}))}))}()}),[t]);var N=function(e){var t=i.energy.map((function(t){return Object(d.a)({},t,{value:e[t.name]})})),a=i.nutrients.map((function(t){return Object(d.a)({},t,{value:e[t.name]})}));f((function(e){return Object(d.a)({},e,{energy:t,nutrients:a})})),!b.includes("energy")&&v((function(e){return[].concat(Object(m.a)(e),["energy","nutrients"])}))},O=function(e,t,n,r){401===n?fe(e,r).then((function(e){console.log("retryRequest successful",e.status,e.data),e.data.data&&e.data.data.requirements&&N(e.data.data.requirements)})).catch((function(e){e.logout&&a(!1),console.error("retryRequest error!",e.status,e.data,e)})):(console.log("Response!: ",e,t,n),t.data&&t.data.requirements&&N(t.data.requirements))},j=i&&i["phys-params-PAL-goal"]?r.a.createElement(Me,{singleErrorList:!0,submitUrl:"/api/save_user_params/",fields:i["phys-params-PAL-goal"],sections:[{title:"\u0424\u0438\u0437\u0438\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b",size:4,columns:4},{title:"\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c & \u0446\u0435\u043b\u044c",size:2,columns:2}],onResponse:O,withAuth:!0}):"",A=i&&i["food-preferences"]?r.a.createElement(Me,{columns:2,singleErrorList:!0,fields:i["food-preferences"],submitUrl:"/api/user_preferences/",formTitle:"\u041f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f",onResponse:O,withAuth:!0}):"",k=i&&i.energy?i.energy.map((function(e,t){return r.a.createElement(Pe,Object.assign({key:t},e))})):"",V=i&&i.nutrients?r.a.createElement(le,{fields:i.nutrients}):"";return _?(l(!0),r.a.createElement(u.a,{to:"/meal-plan"})):r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"preferences-page",style:t?{}:{filter:"blur(10px)"}},r.a.createElement("div",{className:"preferences-page_main-area"},r.a.createElement("div",{className:"preferences-page_grid"},r.a.createElement(K,{blank:!0,width:"600px",className:"preferences-page_phys-params",style:{zIndex:1}},j),r.a.createElement(K,{blank:!0,width:"600px",className:"preferences-page_food-prefs"},A),r.a.createElement(K,{blank:!0,width:"610px",className:"nutrients",empty:!b.includes("energy"),emptyText:"\u0417\u0434\u0435\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442.\\\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b."},r.a.createElement("div",{className:"nutrients_grid"},r.a.createElement("div",{className:"nutrients_title"},r.a.createElement("h2",null,"\u041f\u043e\u0442\u0440\u0435\u0431\u043d\u043e\u0441\u0442\u0438 \u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438")),r.a.createElement("div",{className:"nutrients_energy"},k),r.a.createElement("div",{className:"nutrients_main-nutrients"},V),r.a.createElement("div",{className:"nutrients_other-title"},r.a.createElement("h3",null,"\u041f\u0438\u0442\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0432\u0435\u0449\u0435\u0441\u0442\u0432\u0430")),r.a.createElement("div",{className:"nutrients_other-nutrients-1"},r.a.createElement(le,{fields:lt})),r.a.createElement("div",{className:"nutrients_other-nutrients-2"},r.a.createElement(le,{fields:ct})),r.a.createElement("div",{className:"nutrients_button"},r.a.createElement(Q,{type:"corner",corner:"bottom-right",text:"\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0440\u0430\u0446\u0438\u043e\u043d",onClick:function(){return y(!0)}}))))))))}ot.defaultProps={};var it=ot;a(141);var st=function(){var e=Object(u.g)(),t=Object(n.useState)(null),a=Object(s.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(!1),m=Object(s.a)(i,2),d=m[0],f=m[1];Object(n.useEffect)((function(){var e=function(){var e=localStorage.getItem("access_token");if(!e)return!1;var t=ue(e);return console.log(t),1e3*t.exp-Date.now()>0}();console.log("isAuth",e),e?c(!0):!function(){var e=localStorage.getItem("refresh_token");if(!e)return!1;var t=ue(e);return console.log(t),1e3*t.exp-Date.now()>0}()?c(!1):de().then((function(e){console.log("refreshToken: ",e),200===e.status&&c(!0)})).catch((function(e){console.error(e)}))}),[]),Object(n.useEffect)((function(){fetch("/api/closed/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("access_token")}}).then((function(e){return e.json()})).then((function(e){console.log("closed: ",e)}))}),[]);var p=["/preferences","/preferences/","/meal-plan","/meal-plan/"].includes(e.pathname)&&!l?r.a.createElement(rt,{onAuth:function(e){return c(e)}}):"";return r.a.createElement("div",{className:"app"},r.a.createElement(b,{title:"Nutrition helper",position:"horizontal",size:"70px",zIndex:100,stickToEnd:1},r.a.createElement(o.b,{to:"/models"},"\u041c\u043e\u0434\u0435\u043b\u0438"),r.a.createElement(o.b,{to:"/preferences"},"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b"),r.a.createElement(o.b,{to:"/meal-plan"},"\u041f\u043b\u0430\u043d \u043f\u0438\u0442\u0430\u043d\u0438\u044f"),r.a.createElement("div",{onClick:function(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),c(!1)}},l&&localStorage.getItem("username")||"")),r.a.createElement("div",{className:"app_main"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",render:function(){return r.a.createElement(u.a,{to:"/models"})}}),r.a.createElement(u.b,{path:"/models",component:$e}),r.a.createElement(u.b,{path:"/preferences",render:function(){return r.a.createElement(it,{auth:l,onAuth:function(e){return c(e)},onPlanRequest:function(e){return f(e)}})}}),r.a.createElement(u.b,{path:"/meal-plan",render:function(){return r.a.createElement(ve,{auth:l,onAuth:function(e){return c(e)},onPlanRequest:function(e){return f(e)},awaitingNewPlan:d})}}),r.a.createElement(u.b,{render:function(){return r.a.createElement(u.a,{to:"/"})}})),p))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,null,r.a.createElement(o.a,null,r.a.createElement(st,null)))),document.getElementById("root"))},61:function(e,t,a){}},[[238,1,2]]]);
//# sourceMappingURL=main.1e2975bf.chunk.js.map